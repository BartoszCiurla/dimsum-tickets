{"version":3,"sources":["utils/tree.util.js","utils/randomTreeNodes.js","TreeView/customHooks/useTreeInitialSelectionState.js","TreeView/AutoScroll/SingleSelect.js"],"names":["evalParent","hash","selectedItems","acc","parentId","mixed","parent","parents","push","selectedChilds","filter","child","concat","children","length","newMixed","items","selectedItemsMapper","treeViewRef","allItems","filterFn","selectedIds","get","Object","keys","reduce","id","item","randomEntity","parentID","uuidv4","isGroup","random","randomEntities","undefined","name","type","count","Array","fill","map","useTreeInitialSelectionState","allTreeItems","useState","selectionHash","setSelectionHash","useEffect","initialState","isArray","nodes","onItemClick","console","log","Overview","data","ref","useRef","toggleExpandAll","current","actions","expandAll","fluid","instanceRef","groupIcon","isSingleSelect","itemIcon","selection","plugins","SelectablePluginTree"],"mappings":"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","file":"static/js/25.45140ceb.chunk.js","sourcesContent":["import get from 'lodash/get';\n\n// Meant to hold any reusable functionality related to dimsum's tree view component\n\n/**\n * Verifies if the parent element has selected children\n *\n * @param {object} param all params\n * @param {object} param.hash { [id]: ... } all tree elements in a hash object\n * @param {Array} param.selectedItems The selected items, must include parent key { parent, ... }\n * @param {object} param.acc { items (object), parents (array) }\n * items: all selected elements\n * @param {string} param.parentId The parent identifier\n * @param {boolean} param.mixed Allows marking the selection as indeterminate\n * @returns {object} Same *acc* with the correct parent selected state { items (object), parents (array) }\n */\nexport const evalParent = ({\n  hash,\n  selectedItems,\n  acc,\n  parentId,\n  mixed = false,\n}) => {\n  const parent = hash[parentId];\n  acc.parents.push(parent);\n  let selectedChilds = selectedItems.filter(\n    (child) => child.parent === parentId,\n  );\n  selectedChilds = selectedChilds.concat(\n    acc.parents.filter((child) => child.parent === parentId),\n  );\n  if (parent.children.length > 0) {\n    let newMixed = mixed;\n    if (parent.children.length === selectedChilds.length && !mixed) {\n      acc.items[parentId] = true; // mark as selected\n    } else {\n      acc.items[parentId] = 'mixed';\n      newMixed = true; // mark as indterminate\n    }\n    if (parent.parent && !acc.items[parent.parent]) {\n      return evalParent({\n        hash,\n        selectedItems,\n        acc,\n        parentId: parent.parent,\n        mixed: newMixed,\n      });\n    }\n  }\n  return acc;\n};\n\n/**\n * HOF that returns a mapper for selected items ids from TreeView's state.\n * Can provide a filter for each of the selected elements\n *\n * @example <caption> Returned Function Usage </caption>\n * getSelectedItems((item) => item.type === 'task'); // only getting task elements\n * @param {*} treeViewRef The tree view component's reference\n * @param {*} allItems All tree records/items in a key hash\n * @returns {Function} The getSelectedItems function that receives an optional filter function\n */\nexport const selectedItemsMapper = (treeViewRef, allItems) => (\n  filterFn = () => true,\n  selectedIds = get(treeViewRef, 'current.state.selection', {}), // check this object, could be some timing issues with the selection\n) => {\n  // Timeout is used to get new state from the treeview\n  const selectedItems = Object.keys(selectedIds).reduce(\n    (items, id) => {\n      if (id === 'all' || !selectedIds[id]) return items;\n      const item = allItems[id];\n      if (!item || !filterFn(item)) return items;\n      items.push(item);\n      return items;\n    },\n    [],\n  );\n  return selectedItems;\n};\n","import { random } from 'lodash';\nimport { v4 as uuidv4 } from 'uuid';\n\nexport const randomEntity = (parentID) => {\n  const id = uuidv4();\n  // const group = groups[random(0, 3)];\n  const isGroup = random(0, 4) < 1;\n  const children = isGroup\n    ? randomEntities(random(0, 5), id)\n    : undefined;\n  return {\n    id,\n    name: `${random(0, 1) > 0 ? 'John Doe' : 'Jon Snow'} ${id}`,\n    type: isGroup ? 'group' : 'single',\n    parent: parentID,\n    children,\n  };\n};\nexport const randomEntities = (count, parentID) =>\n  new Array(count).fill(0).map(() => {\n    return randomEntity(parentID);\n  });\n","import { useEffect, useState } from 'react';\nimport { evalParent } from '../../utils/tree.util';\n\n/**\n * Sets the initial selection state\n *\n * @param {object} allTreeItems hash object with all tree elements\n * @param {Array} items The initially selected items. Could be an array for multiSelect or a single object\n * @returns {object} The selections hash object, each key (id) representing a selected tree element\n */\nexport const useTreeInitialSelectionState = (\n  allTreeItems,\n  items = [],\n) => {\n  const [selectionHash, setSelectionHash] = useState({});\n\n  useEffect(() => {\n    let initialState = {};\n    const selectedItems = Array.isArray(items) ? items : [items];\n    if (selectedItems.length) {\n      initialState = selectedItems.reduce(\n        (acc, item) => {\n          acc.items = { ...acc.items, [item.id]: true };\n          if (item.parent && !acc.items[item.parent]) {\n            return evalParent({\n              hash: allTreeItems,\n              selectedItems,\n              acc,\n              parentId: item.parent,\n            });\n          }\n          return acc;\n        },\n        { items: [], parents: [] },\n      );\n    }\n    setSelectionHash(initialState.items);\n  }, [allTreeItems, items]);\n\n  return selectionHash;\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport {\n  TreeView,\n  SelectablePluginTree,\n  // TreeDndPlugin,\n  // TreeToolbarPlugin\n} from '@elliemae/ds-treeview';\nimport Folder from '@elliemae/ds-icons/Folder';\nimport FilePdf from '@elliemae/ds-icons/FilePdf';\nimport { useTreeInitialSelectionState } from '../customHooks/useTreeInitialSelectionState';\nimport { randomEntities } from '../../utils/randomTreeNodes';\n// import { TooltipTextProvider } from \"@elliemae/ds-basic/TruncatedTooltipText\";\n// import renderToolbar from \"./renderToolbar\";\n\nconst nodes = randomEntities(100);\n\nconst onItemClick = (item) => {\n  console.log(111, item);\n};\n\nconst Overview = () => {\n  const [data] = useState(nodes);\n  const selectionHash = useTreeInitialSelectionState(nodes, [\n    nodes[85],\n  ]);\n  const ref = useRef(null);\n\n  const expandAll = () => {\n    const toggleExpandAll = ref.current.actions.toggleExpandAll;\n    console.log('REF', ref.current);\n    if (toggleExpandAll) toggleExpandAll();\n  };\n\n  useEffect(() => {\n    expandAll();\n  }, []);\n\n  return (\n    <TreeView\n      data={data}\n      fluid\n      instanceRef={ref}\n      groupIcon={<Folder />}\n      isSingleSelect\n      itemIcon={<FilePdf />}\n      selection={selectionHash}\n      // labelRenderer={value => value}\n      // onOrderChange={setData}\n      onItemClick={onItemClick}\n      plugins={[SelectablePluginTree]}\n      // renderToolbar={renderToolbar}\n      // showChildrenAmount\n      // sortable\n      // width={400}\n    />\n  );\n};\n\nexport default Overview;\n"],"sourceRoot":""}